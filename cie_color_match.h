/*
 * these color matching functions are the
 * 10-deg XYZ CMFs transformed from the CIE (2006) 2-deg LMS cone fundamentals
 * located at http://cvrl.ioo.ucl.ac.uk/cmfs.htm
 * range is 400 nm - 750 nm
 */
static double cie_colour_match[351][3] =
    {
        {0.01879338, 0.002589775, 0.08508254},
        {0.02226949, 0.003036799, 0.1010753},
        {0.02627978, 0.003541926, 0.1195838},
        {0.03087862, 0.004111422, 0.1408647},
        {0.0361189, 0.004752618, 0.1651644},
        {0.04204986, 0.005474207, 0.1927065},
        {0.04871256, 0.006285034, 0.2236782},
        {0.05612868, 0.007188068, 0.2582109},
        {0.06429866, 0.008181786, 0.2963632},
        {0.07319818, 0.009260417, 0.3381018},
        {0.08277331, 0.01041303, 0.3832822},
        {0.09295327, 0.01162642, 0.4316884},
        {0.1037137, 0.01289884, 0.483244},
        {0.115052, 0.01423442, 0.5379345},
        {0.1269771, 0.0156408, 0.595774},
        {0.1395127, 0.01712968, 0.6568187},
        {0.1526661, 0.01871265, 0.7210459},
        {0.1663054, 0.02038394, 0.7878635},
        {0.1802197, 0.02212935, 0.8563391},
        {0.1941448, 0.02392985, 0.9253017},
        {0.2077647, 0.02576133, 0.9933444},
        {0.2207911, 0.02760156, 1.059178},
        {0.2332355, 0.02945513, 1.122832},
        {0.2452462, 0.03133884, 1.184947},
        {0.2570397, 0.03327575, 1.246476},
        {0.2688989, 0.03529554, 1.308674},
        {0.2810677, 0.03742705, 1.372628},
        {0.2933967, 0.03967137, 1.437661},
        {0.3055933, 0.04201998, 1.502449},
        {0.3173165, 0.04446166, 1.565456},
        {0.3281798, 0.04698226, 1.62494},
        {0.3378678, 0.04956742, 1.679488},
        {0.3465097, 0.05221219, 1.729668},
        {0.3543953, 0.05491387, 1.776755},
        {0.3618655, 0.05766919, 1.822228},
        {0.3693084, 0.06047429, 1.867751},
        {0.3770107, 0.06332195, 1.914504},
        {0.384685, 0.06619271, 1.961055},
        {0.3918591, 0.06906185, 2.005136},
        {0.3980192, 0.0719019, 2.044296},
        {0.4026189, 0.07468288, 2.075946},
        {0.4052637, 0.07738452, 2.098231},
        {0.4062482, 0.08003601, 2.112591},
        {0.406066, 0.08268524, 2.121427},
        {0.4052283, 0.08538745, 2.127239},
        {0.4042529, 0.08820537, 2.132574},
        {0.4034808, 0.09118925, 2.139093},
        {0.4025362, 0.09431041, 2.144815},
        {0.4008675, 0.09751346, 2.146832},
        {0.3979327, 0.1007349, 2.14225},
        {0.3932139, 0.103903, 2.128264},
        {0.3864108, 0.1069639, 2.103205},
        {0.3779513, 0.1099676, 2.069388},
        {0.3684176, 0.1129992, 2.03003},
        {0.3583473, 0.1161541, 1.988178},
        {0.3482214, 0.1195389, 1.946651},
        {0.338383, 0.1232503, 1.907521},
        {0.3288309, 0.1273047, 1.870689},
        {0.3194977, 0.1316964, 1.835578},
        {0.3103345, 0.1364178, 1.801657},
        {0.3013112, 0.1414586, 1.76844},
        {0.2923754, 0.1468003, 1.735338},
        {0.2833273, 0.1524002, 1.701254},
        {0.2739463, 0.1582021, 1.665053},
        {0.2640352, 0.16414, 1.625712},
        {0.2534221, 0.1701373, 1.582342},
        {0.2420135, 0.1761233, 1.534439},
        {0.2299346, 0.1820896, 1.482544},
        {0.2173617, 0.1880463, 1.427438},
        {0.2044672, 0.1940065, 1.369876},
        {0.1914176, 0.1999859, 1.310576},
        {0.1783672, 0.2060054, 1.250226},
        {0.1654407, 0.2120981, 1.189511},
        {0.1527391, 0.2183041, 1.12905},
        {0.1403439, 0.2246686, 1.069379},
        {0.1283167, 0.2312426, 1.010952},
        {0.1167124, 0.2380741, 0.9541809},
        {0.1056121, 0.2451798, 0.8995253},
        {0.09508569, 0.2525682, 0.847372},
        {0.08518206, 0.2602479, 0.7980093},
        {0.0759312, 0.2682271, 0.7516389},
        {0.06733159, 0.2765005, 0.7082645},
        {0.05932018, 0.2850035, 0.6673867},
        {0.05184106, 0.2936475, 0.6284798},
        {0.04486119, 0.3023319, 0.5911174},
        {0.0383677, 0.3109438, 0.5549619},
        {0.03237296, 0.3194105, 0.5198843},
        {0.02692095, 0.3278683, 0.4862772},
        {0.0220407, 0.3365263, 0.4545497},
        {0.01773951, 0.3456176, 0.4249955},
        {0.01400745, 0.3554018, 0.3978114},
        {0.01082291, 0.3660893, 0.3730218},
        {0.008168996, 0.3775857, 0.3502618},
        {0.006044623, 0.389696, 0.3291407},
        {0.004462638, 0.4021947, 0.3093356},
        {0.00344681, 0.4148227, 0.2905816},
        {0.003009513, 0.4273539, 0.2726773},
        {0.003090744, 0.4398206, 0.2555143},
        {0.003611221, 0.452336, 0.2390188},
        {0.004491435, 0.4650298, 0.2231335},
        {0.005652072, 0.4780482, 0.2078158},
        {0.007035322, 0.4915173, 0.1930407},
        {0.008669631, 0.5054224, 0.1788089},
        {0.01060755, 0.5197057, 0.1651287},
        {0.01290468, 0.5343012, 0.1520103},
        {0.01561956, 0.5491344, 0.1394643},
        {0.0188164, 0.5641302, 0.1275353},
        {0.02256923, 0.5792416, 0.1163771},
        {0.02694456, 0.5944264, 0.1061161},
        {0.0319991, 0.6096388, 0.09682266},
        {0.03778185, 0.6248296, 0.08852389},
        {0.04430635, 0.6399656, 0.08118263},
        {0.05146516, 0.6550943, 0.07463132},
        {0.05912224, 0.6702903, 0.06870644},
        {0.0671422, 0.6856375, 0.06327834},
        {0.07538941, 0.7012292, 0.05824484},
        {0.08376697, 0.7171103, 0.05353812},
        {0.09233581, 0.7330917, 0.04914863},
        {0.101194, 0.7489041, 0.04507511},
        {0.1104362, 0.764253, 0.04131175},
        {0.1201511, 0.7788199, 0.03784916},
        {0.130396, 0.792341, 0.03467234},
        {0.141131, 0.804851, 0.03175471},
        {0.1522944, 0.8164747, 0.02907029},
        {0.1638288, 0.827352, 0.02659651},
        {0.1756832, 0.8376358, 0.02431375},
        {0.1878114, 0.8474653, 0.02220677},
        {0.2001621, 0.8568868, 0.02026852},
        {0.2126822, 0.8659242, 0.01849246},
        {0.2253199, 0.8746041, 0.01687084},
        {0.2380254, 0.8829552, 0.01539505},
        {0.2507787, 0.8910274, 0.0140545},
        {0.2636778, 0.8989495, 0.01283354},
        {0.2768607, 0.9068753, 0.01171754},
        {0.2904792, 0.9149652, 0.01069415},
        {0.3046991, 0.9233858, 0.009753},
        {0.3196485, 0.9322325, 0.008886096},
        {0.3352447, 0.9412862, 0.008089323},
        {0.351329, 0.9502378, 0.007359131},
        {0.3677148, 0.9587647, 0.006691736},
        {0.3841856, 0.9665325, 0.006083223},
        {0.4005312, 0.9732504, 0.005529423},
        {0.4166669, 0.9788415, 0.005025504},
        {0.432542, 0.9832867, 0.004566879},
        {0.4481063, 0.986572, 0.004149405},
        {0.4633109, 0.9886887, 0.003769336},
        {0.478144, 0.9897056, 0.003423302},
        {0.4927483, 0.9899849, 0.003108313},
        {0.5073315, 0.9899624, 0.00282165},
        {0.5221315, 0.9900731, 0.00256083},
        {0.537417, 0.99075, 0.002323578},
        {0.5534217, 0.9922826, 0.002107847},
        {0.5701242, 0.9943837, 0.001911867},
        {0.5874093, 0.9966221, 0.001734006},
        {0.6051269, 0.9985649, 0.001572736},
        {0.6230892, 0.9997775, 0.001426627},
        {0.6410999, 0.999944, 0.001294325},
        {0.6590659, 0.99922, 0.001174475},
        {0.6769436, 0.9978793, 0.001065842},
        {0.6947143, 0.9961934, 0.000967322},
        {0.7123849, 0.9944304, 0.000877926},
        {0.7299978, 0.9927831, 0.000796785},
        {0.7476478, 0.9911578, 0.00072315},
        {0.765425, 0.9893925, 0.00065635},
        {0.7834009, 0.9873288, 0.000595768},
        {0.8016277, 0.9848127, 0.000540839},
        {0.8201041, 0.9817253, 0.000491044},
        {0.8386843, 0.9780714, 0.000445905},
        {0.8571936, 0.973886, 0.000404983},
        {0.8754652, 0.9692028, 0.000367882},
        {0.8933408, 0.9640545, 0.000334243},
        {0.9106772, 0.9584409, 0.000303741},
        {0.9273554, 0.9522379, 0.000276081},
        {0.9432502, 0.9452968, 0.000250997},
        {0.9582244, 0.9374773, 0.000228247},
        {0.9721304, 0.9286495, 0.000207613},
        {0.9849237, 0.9187953, 0.000188895},
        {0.9970067, 0.9083014, 0.000171913},
        {1.008907, 0.8976352, 0.000156503},
        {1.021163, 0.8872401, 0.000142518},
        {1.034327, 0.877536, 0.000129823},
        {1.048753, 0.868792, 0.000118297},
        {1.063937, 0.8607474, 0.000107831},
        {1.079166, 0.8530233, 0.0000983246},
        {1.093723, 0.8452535, 0.0000896879},
        {1.106886, 0.8370838, 0.0000818395},
        {1.118106, 0.8282409, 0.0000747058},
        {1.127493, 0.818732, 0.0000682199},
        {1.135317, 0.8086352, 0.0000623213},
        {1.141838, 0.7980296, 0.0000569553},
        {1.147304, 0.786995, 0.0000520725},
        {1.151897, 0.775604, 0.0000476278},
        {1.155582, 0.7638996, 0.0000435808},
        {1.158284, 0.7519157, 0.0000398947},
        {1.159934, 0.7396832, 0.0000365361},
        {1.160477, 0.7272309, 0.000033475},
        {1.15989, 0.7145878, 0.000030684},
        {1.158259, 0.7017926, 0.0000281384},
        {1.155692, 0.6888866, 0.0000258157},
        {1.152293, 0.6759103, 0.0000236957},
        {1.148163, 0.6629035, 0.00002176},
        {1.143345, 0.6498911, 0.0000199918},
        {1.137685, 0.636841, 0.000018376},
        {1.130993, 0.6237092, 0.000016899},
        {1.123097, 0.6104541, 0.0000155482},
        {1.113846, 0.5970375, 0.0000143123},
        {1.103152, 0.5834395, 0.0000131812},
        {1.091121, 0.5697044, 0.0000121455},
        {1.077902, 0.5558892, 0.0000111967},
        {1.063644, 0.5420475, 0.0000103273},
        {1.048485, 0.5282296, 0.00000953013},
        {1.032546, 0.5144746, 0.00000879898},
        {1.01587, 0.5007881, 0.00000812807},
        {0.9984859, 0.4871687, 0.00000751216},
        {0.9804227, 0.473616, 0.00000694651},
        {0.9617111, 0.4601308, 0.00000642678},
        {0.9424119, 0.446726, 0},
        {0.9227049, 0.4334589, 0},
        {0.9027804, 0.4203919, 0},
        {0.8828123, 0.407581, 0},
        {0.8629581, 0.3950755, 0},
        {0.8432731, 0.3828894, 0},
        {0.8234742, 0.370919, 0},
        {0.8032342, 0.3590447, 0},
        {0.7822715, 0.3471615, 0},
        {0.7603498, 0.3351794, 0},
        {0.7373739, 0.3230562, 0},
        {0.713647, 0.3108859, 0},
        {0.6895336, 0.298784, 0},
        {0.6653567, 0.2868527, 0},
        {0.6413984, 0.2751807, 0},
        {0.6178723, 0.2638343, 0},
        {0.5948484, 0.252833, 0},
        {0.57236, 0.2421835, 0},
        {0.5504353, 0.2318904, 0},
        {0.5290979, 0.2219564, 0},
        {0.5083728, 0.2123826, 0},
        {0.4883006, 0.2031698, 0},
        {0.4689171, 0.1943179, 0},
        {0.4502486, 0.185825, 0},
        {0.4323126, 0.1776882, 0},
        {0.415079, 0.1698926, 0},
        {0.3983657, 0.1623822, 0},
        {0.3819846, 0.1550986, 0},
        {0.3657821, 0.1479918, 0},
        {0.3496358, 0.1410203, 0},
        {0.3334937, 0.1341614, 0},
        {0.3174776, 0.1274401, 0},
        {0.3017298, 0.1208887, 0},
        {0.2863684, 0.1145345, 0},
        {0.27149, 0.1083996, 0},
        {0.2571632, 0.1025007, 0},
        {0.2434102, 0.09684588, 0},
        {0.2302389, 0.09143944, 0},
        {0.2176527, 0.08628318, 0},
        {0.2056507, 0.08137687, 0},
        {0.1942251, 0.07671708, 0},
        {0.183353, 0.07229404, 0},
        {0.1730097, 0.06809696, 0},
        {0.1631716, 0.06411549, 0},
        {0.1538163, 0.06033976, 0},
        {0.144923, 0.05676054, 0},
        {0.1364729, 0.05336992, 0},
        {0.1284483, 0.05016027, 0},
        {0.120832, 0.04712405, 0},
        {0.1136072, 0.04425383, 0},
        {0.1067579, 0.04154205, 0},
        {0.1002685, 0.03898042, 0},
        {0.09412394, 0.03656091, 0},
        {0.08830929, 0.03427597, 0},
        {0.0828101, 0.03211852, 0},
        {0.07761208, 0.03008192, 0},
        {0.07270064, 0.02816001, 0},
        {0.06806167, 0.02634698, 0},
        {0.06368176, 0.02463731, 0},
        {0.05954815, 0.02302574, 0},
        {0.05564917, 0.02150743, 0},
        {0.05197543, 0.02007838, 0},
        {0.04851788, 0.01873474, 0},
        {0.04526737, 0.01747269, 0},
        {0.04221473, 0.01628841, 0},
        {0.03934954, 0.01517767, 0},
        {0.0366573, 0.01413473, 0},
        {0.03412407, 0.01315408, 0},
        {0.03173768, 0.01223092, 0},
        {0.02948752, 0.01136106, 0},
        {0.02736717, 0.0105419, 0},
        {0.02538113, 0.00977505, 0},
        {0.02353356, 0.009061962, 0},
        {0.02182558, 0.008402962, 0},
        {0.0202559, 0.007797457, 0},
        {0.01881892, 0.00724323, 0},
        {0.0174993, 0.006734381, 0},
        {0.01628167, 0.006265001, 0},
        {0.01515301, 0.005830085, 0},
        {0.0141023, 0.005425391, 0},
        {0.01312106, 0.005047634, 0},
        {0.01220509, 0.00469514, 0},
        {0.01135114, 0.004366592, 0},
        {0.01055593, 0.004060685, 0},
        {0.009816228, 0.00377614, 0},
        {0.009128517, 0.003511578, 0},
        {0.008488116, 0.003265211, 0},
        {0.007890589, 0.003035344, 0},
        {0.007332061, 0.002820496, 0},
        {0.006809147, 0.002619372, 0},
        {0.006319204, 0.00243096, 0},
        {0.005861036, 0.002254796, 0},
        {0.005433624, 0.002090489, 0},
        {0.005035802, 0.001937586, 0},
        {0.004666298, 0.001795595, 0},
        {0.00432375, 0.001663989, 0},
        {0.004006709, 0.001542195, 0},
        {0.003713708, 0.001429639, 0},
        {0.003443294, 0.001325752, 0},
        {0.003194041, 0.00122998, 0},
        {0.002964424, 0.001141734, 0},
        {0.002752492, 0.001060269, 0},
        {0.002556406, 0.000984885, 0},
        {0.002374564, 0.00091497, 0},
        {0.002205568, 0.00084999, 0},
        {0.002048294, 0.000789516, 0},
        {0.001902113, 0.000733304, 0},
        {0.001766485, 0.000681146, 0},
        {0.001640857, 0.000632829, 0},
        {0.001524672, 0.000588138, 0},
        {0.001417322, 0.000546839, 0},
        {0.001318031, 0.000508635, 0},
        {0.001226059, 0.00047324, 0},
        {0.001140743, 0.000440402, 0},
        {0.001061495, 0.000409893, 0},
        {0.000987795, 0.000381514, 0},
        {0.000919185, 0.00035509, 0},
        {0.000855257, 0.000330467, 0},
        {0.000795643, 0.000307503, 0},
        {0.000740012, 0.000286072, 0},
        {0.000688098, 0.000266072, 0},
        {0.000639786, 0.000247459, 0},
        {0.000594973, 0.000230192, 0},
        {0.000553529, 0.000214223, 0},
        {0.000515311, 0.000199495, 0},
        {0.000480123, 0.000185934, 0},
        {0.000447625, 0.000173407, 0},
        {0.000417485, 0.000161787, 0},
        {0.000389422, 0.000150964, 0},
        {0.000363197, 0.000140847, 0},
        {0.000338628, 0.000131364, 0},
        {0.000315645, 0.000122491, 0},
        {0.000294197, 0.000114206, 0},
        {0.000274224, 0.000106489, 0},
        {0.000255662, 0.0000993144, 0}
};

// static double cie_colour_match[81][3] = {
//         {0.0014,0.0000,0.0065}, {0.0022,0.0001,0.0105}, {0.0042,0.0001,0.0201},
//         {0.0076,0.0002,0.0362}, {0.0143,0.0004,0.0679}, {0.0232,0.0006,0.1102},
//         {0.0435,0.0012,0.2074}, {0.0776,0.0022,0.3713}, {0.1344,0.0040,0.6456},
//         {0.2148,0.0073,1.0391}, {0.2839,0.0116,1.3856}, {0.3285,0.0168,1.6230},
//         {0.3483,0.0230,1.7471}, {0.3481,0.0298,1.7826}, {0.3362,0.0380,1.7721},
//         {0.3187,0.0480,1.7441}, {0.2908,0.0600,1.6692}, {0.2511,0.0739,1.5281},
//         {0.1954,0.0910,1.2876}, {0.1421,0.1126,1.0419}, {0.0956,0.1390,0.8130},
//         {0.0580,0.1693,0.6162}, {0.0320,0.2080,0.4652}, {0.0147,0.2586,0.3533},
//         {0.0049,0.3230,0.2720}, {0.0024,0.4073,0.2123}, {0.0093,0.5030,0.1582},
//         {0.0291,0.6082,0.1117}, {0.0633,0.7100,0.0782}, {0.1096,0.7932,0.0573},
//         {0.1655,0.8620,0.0422}, {0.2257,0.9149,0.0298}, {0.2904,0.9540,0.0203},
//         {0.3597,0.9803,0.0134}, {0.4334,0.9950,0.0087}, {0.5121,1.0000,0.0057},
//         {0.5945,0.9950,0.0039}, {0.6784,0.9786,0.0027}, {0.7621,0.9520,0.0021},
//         {0.8425,0.9154,0.0018}, {0.9163,0.8700,0.0017}, {0.9786,0.8163,0.0014},
//         {1.0263,0.7570,0.0011}, {1.0567,0.6949,0.0010}, {1.0622,0.6310,0.0008},
//         {1.0456,0.5668,0.0006}, {1.0026,0.5030,0.0003}, {0.9384,0.4412,0.0002},
//         {0.8544,0.3810,0.0002}, {0.7514,0.3210,0.0001}, {0.6424,0.2650,0.0000},
//         {0.5419,0.2170,0.0000}, {0.4479,0.1750,0.0000}, {0.3608,0.1382,0.0000},
//         {0.2835,0.1070,0.0000}, {0.2187,0.0816,0.0000}, {0.1649,0.0610,0.0000},
//         {0.1212,0.0446,0.0000}, {0.0874,0.0320,0.0000}, {0.0636,0.0232,0.0000},
//         {0.0468,0.0170,0.0000}, {0.0329,0.0119,0.0000}, {0.0227,0.0082,0.0000},
//         {0.0158,0.0057,0.0000}, {0.0114,0.0041,0.0000}, {0.0081,0.0029,0.0000},
//         {0.0058,0.0021,0.0000}, {0.0041,0.0015,0.0000}, {0.0029,0.0010,0.0000},
//         {0.0020,0.0007,0.0000}, {0.0014,0.0005,0.0000}, {0.0010,0.0004,0.0000},
//         {0.0007,0.0002,0.0000}, {0.0005,0.0002,0.0000}, {0.0003,0.0001,0.0000},
//         {0.0002,0.0001,0.0000}, {0.0002,0.0001,0.0000}, {0.0001,0.0000,0.0000},
//         {0.0001,0.0000,0.0000}, {0.0001,0.0000,0.0000}, {0.0000,0.0000,0.0000}
//     };
